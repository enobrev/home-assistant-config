
    - alias: "Dining Room Presence Increment Timer"
      trigger:
          platform: state
          entity_id: binary_sensor.dining_room_sensor # find-dining_room-motion
          to: 'on'
      action:
        # Increment Duration
        - service: input_number.set_value
          data_template:
              entity_id: input_number.countdown_dining
              value: '{% if states.input_number.countdown_dining.state | int == 0 %}30{% else %}{{ states.input_number.countdown_dining.state | int * 2 }}{% endif %}'

        # Pause Countdown
        - service: timer.pause
          data:
              entity_id: timer.dining_room

    - alias: "Dining Room Presence Start Timer"
      trigger:
          platform: state
          entity_id: binary_sensor.dining_room_sensor # find-dining_room-motion
          to: 'off'
      action:
        # Start Countdown for Duration
        - service: timer.start
          data_template:
              entity_id: timer.dining_room
              duration: '{{ states.input_number.countdown_dining.state | int }}'

    - alias: "Dining Room Presence Timer Finished"
      trigger:
        - platform: event
          event_type: timer.finished
          event_data:
              entity_id: timer.dining_room

      action:
        # Reset Countdown to 0
        - service: input_number.set_value
          data:
              entity_id: input_number.countdown_dining
              value: 0

    - alias: "Dining Room Presence Timer Change"
      trigger:
          platform: template
          value_template: "{{(states.input_number.countdown_dining.state | int) > 0}}"
      action:
        # Presence On
        - service: input_boolean.turn_on
          entity_id: input_boolean.presence_room_dining

        # Start Countdown for Duration
        - service: timer.start
          data_template:
              entity_id: timer.dining_room
              duration: '{{ states.input_number.countdown_dining.state | int }}'

    - alias: "Dining Room Presence Timer Off"
      trigger:
          platform: template
          value_template: "{{(states.input_number.countdown_dining.state | int) <= 0}}"
      action:
        # Presence Off
        - service: input_boolean.turn_off
          entity_id: input_boolean.presence_room_dining

        # Pause Countdown
        - service: timer.cancel
          data:
              entity_id: timer.dining_room